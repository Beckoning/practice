# Java 基础面试题
[TOC]

## 一、JVM
[TOC]


## 一、JVM
### 基础

#### 1、运行时数据区都包含什么？
```
线程共享：堆、方法区
线程独享：程序计数器、虚拟机栈、本地方法栈
```

#### 2、垃圾回收算法？
```
标记清除、标记整理、复制算法、分代回收算法
```
#### 3、判断对象是否有效？
```
标记计数、可达性分析
```
#### 4、GC调优命令？
```
jstack: 查看线程的快照信息。 
jmap: 查询堆栈使用情况  
jstat:JVM运行时的状态信息，包括内存状态、垃圾回收等
``` 
#### 5、young gc触发条件？
``` 
对象直接在年轻代中的Eden区进行分配，如果Eden区域没有足够的空间，那么就会触发YGC（Minor GC）
``` 
#### 6、进入老年代的途径？
``` 
1、YGC时，To Survivor区不足以存放存活的对象，对象会直接进入到老年代。
2、经过多次YGC后，如果存活对象的年龄达到了设定阈值，则会晋升到老年代中。
3、动态年龄判定规则，To Survivor区中相同年龄的对象，如果其大小之和占到了 To Survivor区一半以上的空间，那么大于此年龄的对象会直接进入老年代，而不需要达到默认的分代年龄。
4、大对象：由-XX:PretenureSizeThreshold启动参数控制，若对象大小大于此值，就会绕过新生代, 直接在老年代中分配。
``` 
#### 7、FullGc触发条件？
``` 
1、老年代的内存使用率达到了一定阈值（可通过参数调整），直接触发FGC
2、空间分配担保：在YGC之前，会先检查老年代最大可用的连续空间是否大于新生代所有对象的总空间。如果小于，说明YGC是不安全的，则会查看参数 HandlePromotionFailure 是否被设置成了允许担保失败，如果不允许则直接触发Full GC；如果允许，那么会进一步检查老年代最大可用的连续空间是否大于历次晋升到老年代对象的平均大小，如果小于也会触发 Full GC
3、Metaspace（元空间）在空间不足时会进行扩容，当扩容到了-XX:MetaspaceSize 参数的指定值时，也会触发FGC
4、System.gc() 或者Runtime.gc() 被显式调用时，触发FGC
``` 
#### 8、CMS执行流程？
``` 
初始标记(STW)、并发标记、并发预处理、重新标记(STW)、并发清理、并发重置 
``` 
#### 9、查看cpu标高命令？
``` 
1、通过 top命令查找到这个消耗CPU的进程号PID 8958
2、top -Hp pid   
3、printf '%x\n' PID (PID为上一步中获取到的线程号)转换成对应的16进制PID 5c7e 
4、使用jstack 获取对应的线程信息  jstack 8958 | grep 5c7e
5、jstack pid(进程pid)>stack.dump
``` 



   ·  




      



      


     


    






















